<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Saki Follow Mouse</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
      background: linear-gradient(to bottom, #a2d5f2, #bde4ff); /* é»˜è®¤ç™½å¤© */
      position: relative;
      transition: background 1s ease;
    }

    .night-mode {
      background: radial-gradient(ellipse at center, #0f0f23, #050517, #000000);
    }

    .flip-img {
      position: absolute;
      z-index: 3;
      transition: transform 0.3s ease;
      cursor: pointer;
    }

    .flipped {
      transform: scaleX(-1);
    }

    /* å½©è™¹æ‹–å°¾ç²’å­ */
    .rainbow-particle {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      opacity: 1;
      pointer-events: none;
      box-shadow: 0 0 6px currentColor;
      animation: fadeOut 1s forwards;
    }

    @keyframes fadeOut {
      to {
        transform: scale(2) rotate(360deg);
        opacity: 0;
      }
    }

    /* å…‰æ™•æ‰©æ•£ç‰¹æ•ˆ */
    .glow-ring {
      position: absolute;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.5);
      border-radius: 50%;
      opacity: 1;
      z-index: 0;
      pointer-events: none;
      animation: expandGlow 1s forwards;
    }

    @keyframes expandGlow {
      0% {
        transform: scale(1);
        opacity: 0.6;
      }
      100% {
        transform: scale(6);
        opacity: 0;
        border-color: transparent;
      }
    }

    /* â˜€ï¸ å¤ªé˜³å…‰æ™• */
    .sun {
      position: absolute;
      width: 150px;
      height: 150px;
      background: radial-gradient(circle, rgba(255, 255, 200, 0.4), transparent 70%);
      border-radius: 50%;
      top: 20%;
      left: 80%;
      z-index: 0;
      pointer-events: none;
      animation: sunPulse 3s infinite alternate;
    }

    .moon {
  display: none;
  position: absolute;
  width: 150px;
  height: 150px;
  /* ä¿®æ”¹ä¸ºç±³é»„è‰²æ¸å˜ */
  background: radial-gradient(circle, #f5e6ca, #d2b48c 70%, transparent 90%);
  border-radius: 50%;
  top: 20%;
  left: 80%;
  z-index: 0;
  pointer-events: none;
  /* ä¿®æ”¹ä¸ºç±³é»„è‰²å…‰æ™• */
  box-shadow: 0 0 30px #f5e6ca;
}

    @keyframes sunPulse {
      from { transform: scale(1); }
      to { transform: scale(1.05); }
    }

    /* ğŸŒŒ æ˜Ÿæ˜Ÿé—ªçƒï¼ˆå¤œé—´æ¨¡å¼ï¼‰*/
    .star {
      position: absolute;
      width: 2px;
      height: 2px;
      background: white;
      border-radius: 50%;
      opacity: 0.8;
      z-index: 0;
      pointer-events: none;
      animation: twinkle 2s infinite ease-in-out;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 1; }
    }

    /* ğŸŒ¬ï¸ å¯¹è¯æ°”æ³¡ */
    .speech-bubble {
      position: absolute;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 10px 15px;
      font-family: sans-serif;
      font-size: 14px;
      color: #333;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      white-space: nowrap;
      z-index: 4;
      animation: bubbleFade 3s forwards;
    }

    @keyframes bubbleFade {
      0% { opacity: 1; transform: translateY(0); }
      90% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-20px); }
    }

    /* ğŸ’¡ å¤œé—´æ¨¡å¼æŒ‰é’® */
    .toggle-night-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      background: #fff;
      color: #000;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .toggle-night-btn.night {
      background: #333;
      color: #fff;
    }

    /* ğŸŒŒ é“¶æ²³ç»˜åˆ¶ canvas */
    #galaxyCanvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
      pointer-events: none;
    }

    /* ğŸŒ  æµæ˜Ÿç‰¹æ•ˆ */
    .shooting-star {
      position: absolute;
      width: 2px;
      height: 40px;
      background: linear-gradient(to bottom, #ffffff, transparent);
      transform-origin: top;
      opacity: 0;
      pointer-events: none;
      will-change: transform, opacity;
    }
  </style>
</head>
<body>

  <!-- Saki å›¾ç‰‡ -->
  <img id="saki" src="195px-Saki_1021_00.png" class="flip-img" width="200" />

  <!-- å¤ªé˜³å…‰æ™• / æœˆäº® -->
  <div class="sun"></div>
  <div class="moon"></div>

  <!-- åˆ‡æ¢æŒ‰é’® -->
  <button class="toggle-night-btn" onclick="toggleNightMode()">ğŸŒ™ åˆ‡æ¢å¤œé—´æ¨¡å¼</button>

  <!-- é“¶æ²³ Canvas -->
  <canvas id="galaxyCanvas"></canvas>

  <script>
    const img = document.getElementById('saki');
    const sun = document.querySelector('.sun');
    const moon = document.querySelector('.moon');

    let mouseX = window.innerWidth / 2;
    let mouseY = window.innerHeight / 2;

    let posX = window.innerWidth / 2 - 100;
    let posY = window.innerHeight / 2 - 100;

    const speedFactor = 0.05;

    // ç›‘å¬é¼ æ ‡ä½ç½®
    window.addEventListener('mousemove', (e) => {
      mouseX = e.clientX;
      mouseY = e.clientY;
    });

    // ç¼“åŠ¨åŠ¨ç”»æ›´æ–°ä½ç½®
    function updatePosition() {
      posX += (mouseX - posX) * speedFactor;
      posY += (mouseY - posY) * speedFactor;

      img.style.left = `${posX}px`;
      img.style.top = `${posY}px`;

      createRainbowTrail(posX + 100, posY + 100);
      createGlowEffect(posX + 100, posY + 100);

      requestAnimationFrame(updatePosition);
    }

    // è‡ªåŠ¨ç¿»è½¬
    setInterval(() => {
      img.classList.toggle('flipped');
    }, 300);

    // å¯åŠ¨åŠ¨ç”»
    updatePosition();

    // ğŸŒˆ åˆ›å»ºå½©è™¹æ‹–å°¾ç²’å­
    function createRainbowTrail(x, y) {
      const hue = (Date.now() / 10) % 360;
      const particle = document.createElement('div');
      particle.className = 'rainbow-particle';
      particle.style.left = `${x}px`;
      particle.style.top = `${y}px`;
      particle.style.background = `hsl(${hue}, 100%, 70%)`;
      document.body.appendChild(particle);

      setTimeout(() => {
        particle.remove();
      }, 1000);
    }

    // ğŸ’« åˆ›å»ºå…‰æ™•æ‰©æ•£ç‰¹æ•ˆ
    function createGlowEffect(x, y) {
      const glow = document.createElement('div');
      glow.className = 'glow-ring';
      glow.style.left = `${x - 10}px`;
      glow.style.top = `${y - 10}px`;
      document.body.appendChild(glow);

      setTimeout(() => {
        glow.remove();
      }, 1000);
    }

    // ğŸ—£ï¸ ç‚¹å‡» Saki æ˜¾ç¤ºæ°”æ³¡
    img.addEventListener('click', () => {
      showSpeechBubble(img.offsetLeft + 100, img.offsetTop - 40, "Hello~");
    });

    function showSpeechBubble(x, y, text) {
      const bubble = document.createElement('div');
      bubble.className = 'speech-bubble';
      bubble.textContent = text;
      bubble.style.left = `${x}px`;
      bubble.style.top = `${y}px`;
      document.body.appendChild(bubble);

      setTimeout(() => {
        bubble.remove();
      }, 3000);
    }

    // ğŸŒ™ åˆ‡æ¢å¤œé—´æ¨¡å¼
    function toggleNightMode() {
      const isNight = document.body.classList.contains('night-mode');
      document.body.classList.toggle('night-mode');
      sun.style.display = isNight ? 'block' : 'none';
      moon.style.display = isNight ? 'none' : 'block';

      const btn = document.querySelector('.toggle-night-btn');
      btn.classList.toggle('night');

      if (!isNight) {
        btn.textContent = 'â˜€ï¸ åˆ‡æ¢æ—¥é—´æ¨¡å¼';
        createStars(); // æ·»åŠ æ˜Ÿæ˜Ÿ
        startGalaxy(); // å¼€å§‹ç»˜åˆ¶é“¶æ²³
        startShootingStars(); // å¼€å¯æµæ˜Ÿé›¨
      } else {
        btn.textContent = 'ğŸŒ™ åˆ‡æ¢å¤œé—´æ¨¡å¼';
        removeStars(); // ç§»é™¤æ˜Ÿæ˜Ÿ
        stopGalaxy(); // åœæ­¢é“¶æ²³
        stopShootingStars(); // åœæ­¢æµæ˜Ÿ
      }
    }

    // ğŸŒŸ åˆ›å»ºæ˜Ÿæ˜Ÿç²’å­
    function createStars(count = 200) {
      for (let i = 0; i < count; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = `${Math.random() * window.innerWidth}px`;
        star.style.top = `${Math.random() * window.innerHeight}px`;
        document.body.appendChild(star);
      }
    }

    function removeStars() {
      const stars = document.querySelectorAll('.star');
      stars.forEach(star => star.remove());
    }

    // ğŸŒŒ é“¶æ²³ Canvas
    const galaxyCanvas = document.getElementById('galaxyCanvas');
    let galaxyCtx;
    let galaxyAnimating = false;

    function startGalaxy() {
      galaxyCtx = galaxyCanvas.getContext('2d');
      galaxyCanvas.width = window.innerWidth;
      galaxyCanvas.height = window.innerHeight;
      galaxyAnimating = true;
      drawGalaxy();
    }

    function stopGalaxy() {
      galaxyAnimating = false;
      galaxyCtx.clearRect(0, 0, galaxyCanvas.width, galaxyCanvas.height);
    }

    function drawGalaxy() {
      if (!galaxyAnimating) return;

      const w = galaxyCanvas.width;
      const h = galaxyCanvas.height;

      galaxyCtx.clearRect(0, 0, w, h);

      // é“¶æ²³æ¼©æ¶¡
      const gradient = galaxyCtx.createRadialGradient(w / 2, h / 2, 0, w / 2, h / 2, Math.max(w, h));
      gradient.addColorStop(0, 'rgba(255, 255, 255, 0.2)');
      gradient.addColorStop(0.3, 'rgba(100, 100, 255, 0.1)');
      gradient.addColorStop(0.6, 'rgba(50, 50, 200, 0.05)');
      gradient.addColorStop(1, 'transparent');

      galaxyCtx.fillStyle = gradient;
      galaxyCtx.fillRect(0, 0, w, h);

      requestAnimationFrame(drawGalaxy);
    }

    // ğŸŒ  æµæ˜Ÿç‰¹æ•ˆ
    let shootingInterval = null;

    function startShootingStars() {
      shootingInterval = setInterval(createShootingStar, 2000);
    }

    function stopShootingStars() {
      clearInterval(shootingInterval);
      const stars = document.querySelectorAll('.shooting-star');
      stars.forEach(s => s.remove());
    }

    function createShootingStar() {
      const x = Math.random() * window.innerWidth;
      const y = -50;
      const length = 40 + Math.random() * 20;
      const angle = -45 + Math.random() * 20 - 10; // éšæœºè§’åº¦
      const duration = 2 + Math.random(); // éšæœºæŒç»­æ—¶é—´

      const star = document.createElement('div');
      star.className = 'shooting-star';
      star.style.left = `${x}px`;
      star.style.top = `${y}px`;
      star.style.height = `${length}px`;
      star.style.transform = `rotate(${angle}deg) translateY(0)`;
      star.style.opacity = 0;

      document.body.appendChild(star);

      // ä½¿ç”¨ CSS åŠ¨ç”»æ¨¡æ‹Ÿæµæ˜Ÿè½¨è¿¹
      const keyframes = new KeyframeEffect(
        star,
        [
          { transform: `rotate(${angle}deg) translateY(0)`, opacity: 0 },
          { transform: `rotate(${angle}deg) translateY(400px)`, opacity: 1 },
          { transform: `rotate(${angle}deg) translateY(400px)`, opacity: 0 }
        ],
        { duration: duration * 1000, easing: 'linear' }
      );

      const animation = new Animation(keyframes, document.timeline);
      animation.play();

      setTimeout(() => {
        star.remove();
        animation.cancel();
      }, duration * 1000);
    }

    // ğŸ§¡ æ–°å¢ï¼šå…¨å±€ç‚¹å‡»é—®å€™é€»è¾‘
document.body.addEventListener('click', (e) => {
  // æ’é™¤ç‚¹å‡»çš„æ˜¯åŠŸèƒ½æŒ‰é’®æˆ–å›¾ç‰‡çš„æƒ…å†µ
  if (
    e.target.matches('.toggle-night-btn') ||   // å¤œé—´æ¨¡å¼æŒ‰é’®
    e.target.id === 'saki'                     // Saki å›¾ç‰‡
  ) return;

  // åœ¨ Saki å›¾ç‰‡é™„è¿‘æ˜¾ç¤ºé—®å€™è¯­
  showSpeechBubble(posX + 100, posY - 40, "Hello~");
});
  </script>
</body>
</html>
